<!-- registration.ejs -->

<%- include("partials/header"); -%>
<header class="masthead" style="background-image: url('/assets/img/maa_charan.webp')">
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="site-heading">
                    <!-- <h1>COMPOSE</h1>
                    <span class="subheading">Let's jot something down today...</span> -->
                </div>
            </div>
        </div>
    </div>
</header>

<main class="mb-4">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <h1 class="mb-3 text-center mb-md-3">Registration</h1>
                <p class="text-center">Jai Shree Mataji! ü™∑</p>
                <p class="text-justify fw-bold">Dear Family, in compliance with government regulations, we require the Government ID details of each individual attending the Pooja. Your understanding and cooperation in providing these details are greatly appreciated üíñ</p>
                <form action="/registration" method="post">
                    <!-- Number of Adults -->
                    <div class="form-group">
                        <label for="registrationType">Registration Type:</label>
                        <select class="form-control" name="registrationType" id="registrationType" required>
                            <option value="indian">Indian</option>
                            <option value="foreigner">Foreigner</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="numAdults" class="">Number of Adults:</label>
                        <input class="col-md-2" type="number" class="form-control" name="numAdults" id="numAdults" value="<%= numAdults %>" min="0">
                    </div>
                    
                    <!-- Adult Details -->
                    <div id="adultDetails">
                        <!-- Rows for adults will be added here dynamically -->
                    </div>

                    <!-- Number of Yuvas -->
                    <div class="form-group">
                        <label for="numYuvas">Number of Yuvas:</label>
                        <input class="col-md-2"  type="number" class="form-control" name="numYuvas" id="numYuvas" value="<%= numYuvas %>" min="0">
                    </div>

                    <!-- Yuva Details -->
                    <div id="yuvaDetails">
                        <!-- Rows for yuvas will be added here dynamically -->
                    </div>

                    <!-- Number of Children -->
                    <div class="form-group">
                        <label for="numBals">Number of Bal Shaktis:</label>
                        <input class="col-md-2"  type="number" class="form-control" name="numBals" id="numBals" value="<%= numBals %>" min="0">
                    </div>

                    <!-- Child Details -->
                    <div id="balDetails">
                        <!-- Rows for children will be added here dynamically -->
                    </div>

                    <hr>
                    <h3>Payer's Details</h3>
                    <!-- Payer's Details -->
                    <div id="payerDetails" class="form-row">
                        <div class="form-group col-md-4">
                            <label for="payerFirstName">First Name:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="payerFirstName" id="payerFirstName" required>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="payerLastName">Last Name:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="payerLastName" id="payerLastName" required>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="payerMobile">Mobile No.:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="payerMobile" id="payerMobile" required>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="payerDistrict">District:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="payerDistrict" id="payerDistrict" required>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="payerState">State:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="payerState" id="payerState" required>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="payerPAN">AADHAAR/PAN:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="payerPAN" id="payerPAN" required>
                        </div>
                        <!-- <div class="form-group col-md-4">
                            <label for="payerAADHAAR">AADHAAR No.:</label>
                            <input type="text" class="form-control" name="payerAADHAAR" id="payerAADHAAR" required>
                        </div> -->
                    </div>

                    <p id="totalAmount" class="fw-bold fs-3"></p>
                    <input type="hidden" name="totalAmount" id="totalAmountInput" value="<%= totalAmount %>">
                    <p>Please check the filled details properly before proceeding to the payment section.</p>
                    <hr>
                    <!-- Section for Seminar Dedication Amount -->
                    <div class="mt-3 mb-2">
                        <h3  class="text-center">Payment Methods</h3>
                        <ul>
                            <li>1Ô∏è‚É£ QR Code (‡§ï‡•ç‡§Ø‡•Ç ‡§Ü‡§∞ ‡§ï‡•ã‡§°)</li>
                            <li>2Ô∏è‚É£ Bank Details (‡§¨‡•á‡§Ç‡§ï ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞)</li>
                        </ul>
                        <p class="text-center">‚ïê‚ïê‚îÅ‚îÅ‚îÅ‚îÅ‚ú•‚óà‚ú•‚îÅ‚îÅ‚îÅ‚îÅ‚ïê‚ïê</p>
                        <h3 class="text-center">1Ô∏è‚É£ QR Code</h3>
                        <img class="col-md-6 rounded mx-auto d-block" src="/assets/img/qr.png">
                        <hr>
                        <h3 class="text-center mt-3 mb-0">2Ô∏è‚É£ Bank Details</h3>
                        <p class="fw-bold">A/C Name: H H Shri Mataji Nirmala Devi
                            Sahaja Yoga Trust<br>
                            Account Number : 5340025523<br>
                            Bank: CENTRAL BANK OF INDIA, Linga,
                            Dist. Chhindwara.<br>
                            IFSC Code : CBIN0282129<br>
                            BRANCH CODE: 2129</p>
                        <p>The amount can be transferred through RTGS and NEFT. Please insert UTR Number after payment, to complete the registration process.</p>
                        <p>‡§Ü‡§∞‡§ü‡•Ä‡§ú‡•Ä‡§è‡§∏ ‡§î‡§∞ ‡§è‡§®‡§à‡§è‡§´‡§ü‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§∞‡§æ‡§∂‡§ø ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ UTR ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç‡•§</p>
                        <p class="fw-bold">üî¥NOTE: - Take screenshot after the payment is complete.</p>
                        <p class="fw-bold">üî¥‡§®‡•ã‡§ü: - ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§™‡•Ç‡§∞‡§æ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®‡§∂‡•â‡§ü ‡§≤‡•á‡§Ç‡•§</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="utrNumber">UTR Number:<span class="text-danger fw-bold">*</span></label>
                        <input type="text" class="form-control" name="utrNumber" id="utrNumber" required>
                    </div>
                    <h3 class="fw-bold fs-4 mb-3">Please bring a print out of the transaction as a payment proof!</h3>
                    <button type="submit" class="btn btn-success custom-btn  rounded mx-auto d-block">Submit</button>
                </form>
            </div>
        </div>
    </div>
</main>

<!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
    $(document).ready(function () {
        function addRows(category, count) {
            for (let i = 1; i <= count; i++) {
                let rowHtml = `
                    <div class="form-row">
                        <div class="form-group col-md-4">
                            <label for="${category}Name${i}">${category.charAt(0).toUpperCase() + category.slice(1)} ${i} Name:<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="${category}Name${i}" id="${category}Name${i}" required>
                        </div>

                        <div class="form-group col-md-4">
                            <label for="${category}Aadhar${i}">${category.charAt(0).toUpperCase() + category.slice(1)} ${i} Aadhar/PAN<span class="text-danger fw-bold">*</span></label>
                            <input type="text" class="form-control" name="${category}Aadhar${i}" id="${category}Aadhar${i}" required>
                        </div>

                        <div class="form-group col-md-4">
                            <label for="${category}Gender${i}">${category.charAt(0).toUpperCase() + category.slice(1)} ${i} Gender:<span class="text-danger fw-bold">*</span></label>
                            <select class="form-control" name="${category}Gender${i}" id="${category}Gender${i}" required>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <!-- Add other gender options as needed -->
                            </select>
                        </div>
                    </div>
                `;
                $(`#${category}Details`).append(rowHtml);
            }
        }

        $("#numAdults").on("change", function () {
            const count = parseInt($(this).val(), 10);
            $("#adultDetails").empty();
            addRows("adult", count);
        });

        $("#numYuvas").on("change", function () {
            const count = parseInt($(this).val(), 10);
            $("#yuvaDetails").empty();
            addRows("yuva", count);
        });

        $("#numBals").on("change", function () {
            const count = parseInt($(this).val(), 10);
            $("#balDetails").empty();
            addRows("bal", count);
        });

        function calculateTotalAmount() {
            const nonForeignerPrices = {
                adult: 2300,
                yuva: 1800,
                bal: 1200
            };

            const foreignerPrices = {
                adult: 5000,
                yuva: 5000,
                bal: 5000
            };

            const registrationType = $("#registrationType").val();
            const prices = registrationType === "foreigner" ? foreignerPrices : nonForeignerPrices;

            const numAdults = parseInt($("#numAdults").val(), 10) || 0;
            const numYuvas = parseInt($("#numYuvas").val(), 10) || 0;
            const numBals = parseInt($("#numBals").val(), 10) || 0;

            // Calculate total amount
            const totalAmount = (numAdults * prices.adult) + (numYuvas * prices.yuva) + (numBals * prices.bal);

            // Display total amount in the form or update the UI as needed
            $("#totalAmount").text(`Total Amount to be paid: ${totalAmount} INR`);

            // Set the value of the hidden input
            $("#totalAmountInput").val(totalAmount);

            // Enable or disable the submit button based on totalAmount
            $("button[type='submit']").prop("disabled", !(totalAmount > 0));
        }

        // Disable submit button on page load
        $("button[type='submit']").prop("disabled", true);

        calculateTotalAmount();

        // Add event listeners for number inputs
        $("#numAdults, #numYuvas, #numBals").on("change", calculateTotalAmount);

    });
</script>
<%- include("partials/footer"); -%>
